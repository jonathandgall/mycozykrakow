"use strict";function bounceMarker(r){null!==r.getAnimation()?r.setAnimation(null):(r.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){r.setAnimation(null)},2e3))}function initMap(){map=new google.maps.Map(document.getElementById("map"),{center:{lat:50.06193,lng:19.94},zoom:13});for(var r=0;r<restaurantModel.currentArray.length;r++)restaurantModel.currentArray[r].marker=new google.maps.Marker({map:map,animation:null,position:{lat:restaurantModel.currentArray[r].lat,lng:restaurantModel.currentArray[r].lng},title:restaurantModel.currentArray[r].name}),function(r){function e(){for(var e,n=0;n<restaurantModel.currentArray.length;n++)restaurantModel.currentArray[n].marker==r&&(e=restaurantModel.currentArray[n]);bounceMarker(r),_showInfoWindow(e)}r.addListener("click",e)}(restaurantModel.currentArray[r].marker)}function _showInfoWindow(r){$.getJSON("https://api.foursquare.com/v2/venues/"+r.f2venueid+"/photos?&client_id=1QPPXDQSLOXUV5FGAANQG31S21EGUNNXJDP3HIXVECXWVXZ3&client_secret=IA0FKPF1FZ3AS4L1QNDQEFHC15B45ZY5ZXPDMX51UJL550TL&&v=20170724").done(function(e){var n=e.response.photos.items[0].prefix+e.response.photos.items[0].width+"x"+e.response.photos.items[0].height+e.response.photos.items[0].suffix,o=new google.maps.InfoWindow({content:'<p class="infowindow-render">A picture from inside</p><p><img src="'+n+'" alt="Pictures" width="100px"></p>'});clearInfoWindow(),o.open(map,r.marker),infowindowsArray.push(o)}).fail(function(){errorModel.errorMessage("Foursquare"),$("#myModal").modal({keyboard:!0})})}function clearInfoWindow(){for(var r=0;r<infowindowsArray.length;r++)infowindowsArray[r].close();infowindowsArray.length=0}function init(){var r={restaurants:ko.observableArray(restaurantModel.currentArray.slice(0,restaurantModel.currentArray.length)),query:ko.observable(""),search:function(e){r.restaurants.removeAll(),clearInfoWindow();for(var n=0;n<restaurantModel.currentArray.length;n++)restaurantModel.currentArray[n].name.toLowerCase().indexOf(e.toLowerCase())>=0?(r.restaurants.push(restaurantModel.currentArray[n]),restaurantModel.currentArray[n].marker.setMap(map)):restaurantModel.currentArray[n].marker.setMap(null)},showInfoWindow:function(r){bounceMarker(r.marker),_showInfoWindow(r)}};r.query.subscribe(r.search),ko.applyBindings(r,document.getElementById("bindingScope"))}var restaurantModel;$.getJSON("./scripts/restaurant.json",function(r){restaurantModel=r}).done(function(){init(),$.getScript("https://maps.googleapis.com/maps/api/js?v=3&key=AIzaSyCW39emCmlKM0E8h_gW5rQnQA-a0JdBTpc&callback=initMap").fail(function(){errorModel.errorMessage("the google map could not loaded"),$("#myModal").modal({keyboard:!0})})}).fail(function(){errorModel.errorMessage("the restaurants database"),$("#myModal").modal({keyboard:!0})});var map,infowindowsArray=[],errorModel={errorMessage:ko.observable()};ko.applyBindings(errorModel,document.getElementById("myModal"));